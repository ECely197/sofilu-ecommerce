<div class="auth-container">
  <div class="auth-card">
    <h2 class="auth-title">Crea tu Cuenta en Sofilu</h2>

    <form [formGroup]="registerForm" (ngSubmit)="handleSubmit()">
      <!-- 1. CAMPO DE NOMBRE DE USUARIO -->
      <div class="material-field">
        <input
          id="displayName"
          type="text"
          formControlName="displayName"
          class="material-input"
          placeholder=" "
        />
        <label for="displayName" class="material-label"
          >Nombre de Usuario</label
        >
        @if (registerForm.get('displayName')?.touched &&
        registerForm.get('displayName')?.invalid) {
        <div class="error-text">
          El nombre debe tener al menos 3 caracteres.
        </div>
        }
      </div>

      <!-- 4. CAMPO DE CORREO ELECTRÓNICO -->
      <div class="material-field">
        <input
          id="email"
          type="email"
          formControlName="email"
          class="material-input"
          placeholder=" "
        />
        <label for="email" class="material-label">Correo Electrónico</label>
        @if (registerForm.get('email')?.touched &&
        registerForm.get('email')?.invalid) {
        <div class="error-text">
          @if (registerForm.get('email')?.hasError('required')) {
          <span>El correo es requerido.</span> } @if
          (registerForm.get('email')?.hasError('email')) {
          <span>Introduce un correo electrónico válido.</span> }
        </div>
        }
      </div>

      <!-- CAMPO DE CONTRASEÑA-->
      <div class="material-field password-field">
        <input
          id="password"
          [type]="hidePassword() ? 'password' : 'text'"
          formControlName="password"
          class="material-input"
          placeholder=" "
        />
        <label for="password" class="material-label">Contraseña</label>
        <button
          type="button"
          class="password-toggle"
          (click)="hidePassword.set(!hidePassword())"
        >
          <span class="material-symbols-outlined">
            {{ hidePassword() ? "visibility_off" : "visibility" }}
          </span>
        </button>
        @if (registerForm.get('password')?.touched &&
        registerForm.get('password')?.invalid) {
        <div class="error-text">
          @if (registerForm.get('password')?.hasError('required')) {
          <span>La contraseña es requerida.</span> } @if
          (registerForm.get('password')?.hasError('minlength')) {
          <span>La contraseña debe tener al menos 6 caracteres.</span> }
        </div>
        }
      </div>

      <!-- CAMPO DE CONFIRMAR CONTRASEÑA -->
      <div class="material-field password-field">
        <input
          id="confirmPassword"
          [type]="hideConfirmPassword() ? 'password' : 'text'"
          formControlName="confirmPassword"
          class="material-input"
          placeholder=" "
        />
        <label for="confirmPassword" class="material-label"
          >Confirmar Contraseña</label
        >
        <button
          type="button"
          class="password-toggle"
          (click)="hideConfirmPassword.set(!hideConfirmPassword())"
        >
          <span class="material-symbols-outlined">
            {{ hideConfirmPassword() ? "visibility_off" : "visibility" }}
          </span>
        </button>
        @if (registerForm.hasError('passwordsMismatch') &&
        registerForm.get('confirmPassword')?.touched) {
        <div class="error-text">Las contraseñas no coinciden.</div>
        }
      </div>

      <div class="checkbox-group">
        <div class="checkbox-field">
          <input
            id="acceptsMarketing"
            type="checkbox"
            formControlName="acceptsMarketing"
          />
          <label for="acceptsMarketing"
            >Deseo recibir promociones y novedades por email.</label
          >
        </div>
        <div class="checkbox-field">
          <input
            id="agreedToTerms"
            type="checkbox"
            formControlName="agreedToTerms"
          />
          <label for="agreedToTerms">
            He leído y acepto los
            <a routerLink="/terms" target="_blank">Términos y Condiciones</a>.
          </label>
        </div>
        @if(registerForm.get('agreedToTerms')?.touched &&
        registerForm.get('agreedToTerms')?.hasError('requiredTrue')) {
        <div class="error-text">Debes aceptar los términos para continuar.</div>
        }
      </div>

      <!-- BOTÓN DE ENVÍO -->
      <button
        type="submit"
        [disabled]="registerForm.invalid"
        class="auth-button"
        appRipple
      >
        Crear Cuenta
      </button>

      <!-- Separador visual "O" -->
      <div class="separator"><span>O</span></div>

      <!-- BOTÓN DE INICIO DE SESIÓN CON GOOGLE -->
      <button
        type="button"
        (click)="handleGoogleLogin()"
        class="google-button"
        appRipple
      >
        <!-- Icono de Google en SVG -->
        <svg
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <!-- ... paths del SVG ... -->
        </svg>
        <span>Continuar con Google</span>
      </button>
    </form>

    <!-- Enlace para redirigir a la página de inicio de sesión -->
    <p class="auth-link">
      ¿Ya tienes una cuenta? <a routerLink="/login">Inicia Sesión</a>
    </p>
  </div>
</div>
