<header class="page-header">
  <h1>Pedidos de Clientes</h1>
</header>

<div class="search-bar-wrapper">
  <div class="search-field">
    <span class="material-symbols-outlined">search</span>
    <input
      type="text"
      [formControl]="searchControl"
      placeholder="Buscar por nombre o número de pedido..."
      class="search-input"
    />
  </div>
</div>

<div class="table-container">
  @if (isLoading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Cargando pedidos...</p>
    </div>
  } @else {
    @if (orders().length > 0) {
      <div class="order-list-grid" [@listAnimation]="orders().length">
        <!-- CABECERA (Solo Desktop) -->
        <div class="order-row header">
          <div class="col">Nº Pedido</div>
          <div class="col">Fecha</div>
          <div class="col">Cliente</div>
          <div class="col text-right">Total</div>
          <div class="col center">Estado</div>
          <div class="col right">Acciones</div>
        </div>

        <!-- FILAS DE PEDIDOS -->
        @for (order of orders(); track order._id) {
          <div class="order-row item">
            <!-- ID -->
            <div class="col id-col" data-label="Pedido">
              <span class="hash">#</span>{{ order._id.slice(-6).toUpperCase() }}
            </div>

            <!-- Fecha -->
            <div class="col date-col" data-label="Fecha">
              {{ order.createdAt | date: "mediumDate" }}
            </div>

            <!-- Cliente -->
            <div class="col client-col" data-label="Cliente">
              {{ order.customerInfo.name }}
            </div>

            <!-- Total -->
            <div class="col total-col text-right" data-label="Total">
              {{ order.totalAmount | currency: "COP" : "symbol" : "1.0-0" }}
            </div>

            <!-- Estado -->
            <div class="col status-col center" data-label="Estado">
              <span class="status-pill" [ngClass]="order.status.toLowerCase()">
                {{ order.status }}
              </span>
            </div>

            <!-- Acciones -->
            <div class="col actions-col right" data-label="Acciones">
              <div class="actions-wrapper">
                <a
                  [routerLink]="['/admin/orders', order._id]"
                  class="btn-icon details"
                  title="Ver Detalles"
                  appRipple
                >
                  <span class="material-symbols-outlined">visibility</span>
                  <span class="btn-text">Detalles</span>
                </a>
                <button
                  (click)="deleteOrder(order._id)"
                  class="btn-icon delete"
                  title="Eliminar"
                  appRipple
                >
                  <span class="material-symbols-outlined">delete</span>
                  <span class="btn-text">Eliminar</span>
                </button>
              </div>
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="empty-state">
        <p>No se encontraron pedidos.</p>
      </div>
    }
  }
</div>
