@if (product) {
<!-- El enlace ahora es el contenedor principal de la tarjeta -->
<a
  [routerLink]="isOutOfStock() ? null : ['/product', product._id]"
  class="product-card"
  [class.out-of-stock]="isOutOfStock()"
>
  <!-- Contenedor de la Imagen con las burbujas de acciÃ³n -->
  <div class="image-container">
    @if (isOutOfStock()) {
    <div class="stock-badge">Agotado</div>
    } @if (product.images && product.images.length > 0) {
    <img
      [src]="product.images[0]"
      [alt]="product.name"
      class="product-image"
      loading="lazy"
      decoding="async"
    />
    } @else {
    <div class="image-placeholder"></div>
    }

    <!-- Las burbujas ahora son siempre visibles en el hover de la imagen -->
    @if (authService.currentUser$ | async) {
    <div class="action-bubbles">
      <button
        (click)="toggleWishlist($event)"
        class="bubble-button"
        [class.active]="isProductInWishlist()"
      >
        <span class="material-symbols-outlined">{{
          isProductInWishlist() ? "favorite" : "favorite_border"
        }}</span>
      </button>
      <button (click)="addToCart($event)" class="bubble-button">
        <span class="material-symbols-outlined">add_shopping_cart</span>
      </button>
    </div>
    }
  </div>

  <!-- Contenido de texto -->
  <div class="card-content">
    <h3 class="product-name">{{ product.name }}</h3>
    <p class="price">
      {{ displayPrice | currency : "COP" : "symbol" : "1.0-0" }}
    </p>
  </div>
</a>
}
