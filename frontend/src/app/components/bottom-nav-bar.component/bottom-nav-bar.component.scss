@use "../../../../buttons";

:host {
  display: none;
  @media (max-width: 767px) {
    display: block;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: 1000;
    pointer-events: none;
  }
}

// --- BUSCADOR FLYOUT (El culpable) ---
.search-flyout-container {
  position: fixed;
  inset: 0;
  z-index: 1050; // Encima de todo
  pointer-events: none; // Por defecto no bloquea nada

  &.is-open {
    pointer-events: auto; // Solo bloquea cuando está abierto
  }
}

.search-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.4);
  backdrop-filter: blur(8px);
  
  // Estado inicial: Invisible
  opacity: 0;
  visibility: hidden; 
  transition: opacity 0.3s ease, visibility 0s 0.3s; // Delay en visibility para que no corte la animación

  // Estado abierto
  .search-flyout-container.is-open & {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease, visibility 0s 0s;
  }
}

.mobile-search-bar {
  position: absolute;
  top: 0; left: 0; right: 0;
  padding: 1rem;
  z-index: 2;

  // --- ESTADO INICIAL: OCULTO Y FUERA ---
  transform: translateY(-120%); // Más arriba para asegurar
  opacity: 0;                   // Totalmente transparente
  visibility: hidden;           // El navegador lo ignora visualmente
  
  transition: 
    transform 0.4s cubic-bezier(0.16, 1, 0.3, 1),
    opacity 0.3s ease,
    visibility 0s 0.4s; // Espera a que suba para ocultarse del DOM visual

  // --- ESTADO ABIERTO: VISIBLE ---
  .search-flyout-container.is-open & {
    transform: translateY(0);
    opacity: 1;
    visibility: visible;
    transition: 
      transform 0.4s cubic-bezier(0.16, 1, 0.3, 1),
      opacity 0.3s ease,
      visibility 0s 0s;
  }

  form {
    position: relative; display: flex;
    .search-input {
      width: 100%;
      background: rgba(255, 255, 255, 0.95);
      border: none;
      padding: 1rem 1rem 1rem 3.5rem;
      border-radius: 1.5rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      font-size: 1rem;
      &:focus { outline: none; }
    }
    .search-submit-btn {
      position: absolute; top: 50%; right: 10px; transform: translateY(-50%);
      background: var(--pastel-pink); color: white; border: none;
      width: 40px; height: 40px; border-radius: 50%;
      display: grid; place-items: center;
    }
  }
}

// --- BARRA DE NAVEGACIÓN INFERIOR ---
.bottom-nav-bar {
  position: absolute;
  bottom: 1rem; left: 1rem; right: 1rem;
  height: 70px;
  transform: translateY(150%);
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  pointer-events: auto;
  &.is-visible { transform: translateY(0); }
}

.nav-content {
  position: relative;
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 100%;
  padding: 0 0.5rem;
  
  // --- MÁS VIDRIO (Más transparente) ---
  background-color: rgba(255, 255, 255, 0.65); // Antes 0.85
  backdrop-filter: blur(40px) saturate(180%); // Blur intenso para compensar transparencia
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  
  border: 1px solid rgba(255, 255, 255, 0.5);
  border-radius: 2rem;
  
  // Sombra más suave y difusa
  box-shadow: 
    0 10px 40px -10px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.6);
}

.nav-group {
  display: flex;
  justify-content: space-around;
  align-items: center;
  width: calc(50% - 35px);
}

.nav-pill {
  position: absolute;
  top: 50%; left: 0;
  transform: translateY(-50%);
  height: 50px;
  
  // Gradiente suave semi-transparente
  background: linear-gradient(135deg, rgba(255, 209, 220, 0.8) 0%, rgba(255, 182, 193, 0.9) 100%);
  
  // Bordes y Brillos para efecto 3D/Líquido
  border: 1px solid rgba(255, 255, 255, 0.4);
  border-radius: 1.5rem;
  z-index: 0;
  
  box-shadow: 
    0 4px 15px rgba(255, 182, 193, 0.4), // Resplandor rosa
    inset 0 2px 5px rgba(255, 255, 255, 0.3); // Brillo superior interno
  
  transition: 
    left 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), // Movimiento elástico
    width 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), 
    opacity 0.2s;
}

.nav-item {
  position: relative; z-index: 1; display: flex; flex-direction: column;
  align-items: center; justify-content: center; text-decoration: none;
  color: #888; width: 64px; height: 100%; background: none; border: none; cursor: pointer; padding: 0;
  transition: color 0.2s;

  .material-symbols-outlined { font-size: 1.6rem; transition: transform 0.2s; }
  .label { font-size: 0.65rem; font-weight: 700; margin-top: 2px; opacity: 0.8; }

  &.active {
    color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    .material-symbols-outlined { transform: translateY(-2px); }
  }
}

.fab {
  position: absolute; top: -25px; left: 50%; transform: translateX(-50%);
  width: 64px; height: 64px; border-radius: 50%;
  background: linear-gradient(135deg, #FFD1DC, #ffc3a0); color: white;
  border: 4px solid rgba(255,255,255,0.8);
  box-shadow: 0 8px 20px rgba(255, 160, 122, 0.4);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; z-index: 2; transition: transform 0.2s;
  
  &:active { transform: translateX(-50%) scale(0.95); }
  .material-symbols-outlined { font-size: 1.8rem; }
  .cart-badge {
    position: absolute; top: 0; right: 0; background: white; color: #ff9a9e;
    border-radius: 50%; width: 22px; height: 22px; font-size: 0.75rem; font-weight: 800;
    display: grid; place-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
}

.icon-button {
  @extend .nav-item; 
  position: relative;
  .wishlist-badge {
    position: absolute; top: 8px; right: 12px; // Ajustado un poco por el texto
    background: #ff5a5f; // Rojo/Rosa fuerte para notificaciones
    width: 8px; height: 8px; border-radius: 50%;
    text-indent: -9999px; 
    box-shadow: 0 0 0 2px white;
    z-index: 2;
  }
}