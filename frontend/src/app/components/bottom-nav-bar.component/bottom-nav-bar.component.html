<!-- Contenido Completo, Unificado y Corregido para: bottom-nav-bar.component.html -->

<div
  class="search-flyout-container"
  [class.is-open]="uiStateService.isMobileSearchVisible()"
>
  <div
    class="search-overlay"
    (click)="uiStateService.closeMobileSearch()"
  ></div>

  <div class="mobile-search-bar">
    <form (submit)="handleSearch($event, searchInput)">
      <input
        #searchInput
        type="search"
        placeholder="Buscar productos..."
        class="search-input"
        autofocus
      />
      <button type="submit" class="search-submit-btn">
        <span class="material-symbols-outlined">search</span>
      </button>
    </form>
  </div>
</div>

<!-- BARRA DE NAVEGACIÓN INFERIOR (Solo hay una) -->
<nav class="bottom-nav-bar" [class.is-visible]="isNavBarVisible()">
  <div class="nav-content">
    <!-- Burbuja de animación (sin cambios) -->
    <div
      class="nav-pill"
      [style.left]="pillStyle().left"
      [style.width]="pillStyle().width"
      [style.opacity]="pillStyle().opacity"
    ></div>

    <!-- Grupo de la Izquierda -->
    <div class="nav-group">
      <a
        #navItem
        routerLink="/"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        class="nav-item"
      >
        <span class="material-symbols-outlined">home</span>
        <span class="label">Inicio</span>
      </a>
       <button
        #navItem
        (click)="uiStateService.openWishlistFlyout()"
        class="icon-button nav-item"  
        aria-label="Abrir lista de deseos"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
      >
        <!-- Agregamos la clase nav-item arriba para heredar estilos de layout -->
        <span class="material-symbols-outlined">favorite</span>
        <!-- ¡AQUÍ ESTÁ EL TEXTO QUE FALTABA! -->
        <span class="label">Favoritos</span>
        
        @if (wishlistService.wishlistProductIds().length > 0) {
        <span class="wishlist-badge">{{
          wishlistService.wishlistProductIds().length
        }}</span>
        }
      </button>
    </div>

    <!-- Botón Flotante Central (sin cambios) -->
    <button (click)="uiStateService.openCartFlyout()" class="fab">
      <span class="material-symbols-outlined">shopping_bag</span>
      @if(cartService.totalItems() > 0){
      <span class="cart-badge">{{ cartService.totalItems() }}</span>
      }
    </button>

    <!-- Grupo de la Derecha (Unificado) -->
    <div class="nav-group">
      <!-- Botón de Búsqueda -->
      <button
        (click)="uiStateService.openMobileSearch()"
        class="nav-item"
        #navItem
      >
        <span class="material-symbols-outlined">search</span>
        <span class="label">Buscar</span>
      </button>
      <!-- Enlace a la Cuenta -->
      <a
        #navItem
        routerLink="/account"
        routerLinkActive="active"
        class="nav-item"
      >
        <span class="material-symbols-outlined">person</span>
        <span class="label">Cuenta</span>
      </a>
    </div>
  </div>
</nav>
